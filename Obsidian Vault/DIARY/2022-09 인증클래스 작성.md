## 1. 메소드 직접접근 처리 방법 재확인 
 - 기존 사이트에는 인증모듈 없이, 로그인시에 접근 메뉴를 생성하는 방식으로 인증을 진행하고 있어 아래와 같은 문제가 발생함. (보안지적사항)
	 - 이 경우 URI 직접 링크접속을 통해 권한이없는 메뉴접근 가능
	 - 파라미터 변조를 통해 권한취득가능 => 사용자정보 변조 감지 생성 


## 2021-05 조치사항 (인터셉터)
1) 링크 이동시 사용자-프로그램 인터셉터 설정 (DB를 통해 해당 메뉴접근 권한 확인)
2) 해당 인터셉터에 사용자 권한 및 키를 변조할 수 없도록 USER테이블 체크 추가

→ 해당 방법으로 프로그램 접근 문제는 해결가능하나, select 가 아닌 등록/수정/삭제의 직접접근을 막을 수가 없었음

사유1) 일반적으로 `(프로그램명)/index.do` 를 통해 CRUD 에 접근해야하나, 해당 사이트의 레거시 구조는 모든 CRUD 에 명칭을 부여하여 사용하는 구조
사유2) 각화면의 URI가 `(프로그램명)/insert.do` 이거나 `(프로그램명)/update.do` 인 경우를 캐치할 수 없음 (프로그램 NO를 controller 안에서 가져올 수 없음)


## 2021-12 조치사항 (AOP)
 - 민감정보가 유달리 많은 프로그램에 대하여 uri - AOP 설정 
 - 특정 키워드 (ex: write, create, insert 등이 포함될때마다 권한체크 재실행)

→ 해당 방법으로 조치가 가능하지만, 모든 URI가 공통패턴으로 부여된 것이 아니기에, 예외조치할 모든 URI를 기술해야하는 단점이 발생 


## 2022-05 조치사항 (권한 MAP생성)

#### 사전조사내용 
 - 단순히 URI을 이용해 권한이 없는 화면으로 이동, CRUD를 수행한다면.. HTTP-HEADER `REFERE` 객체를 이용해 URI 직접 접근을 막을 수 있음
	 - URI로 이동시 리퍼러 객체는 NULL 
 - 단 해당 객체는 변조가 가능하므로.. URI맵을 대체할 수 없을듯함
```java

/* # HTTP-HEADER:REFERE 대체 가능 여부 테스트 ⇒ 불가 */

/* # AuthCheck ---------------------------- 
 *   1. 리퍼러가 비어있지 않으면서   - private  boolean  hasReferer()? t/f 
 *   2. 예외 URI가 아니고           - private  boolean  isAllowURI()? t/f
 *   3. 권한이 부여되어 있다면       - private  boolean  hasMenuAuth()? t/f  

  으로 구현했으나, 아래의 경우에 직접 접근을 방지 할 수 없음 

  - 리퍼러가 없을때, 등록화면엔 접근 불가하나
  - 저장 AJAX를 따 파라미터를 넘기면 저장 가능
  - ※ 추가 확인 필요 : HTTP-HEADER 객체의 종류 

 */


```


#### 조치내용
 - 2022-05 조치사항으로 URI 맵생성
   → `관리화면이 없어 SQL 로 직접 입력해줘야하는 단점` 있음  (추후개발)
 - 맵을 만드는데 지대한 시간이 소요..  (controller 에 기술된 모든 uri를 조사하는 작업이 필요했음 )
 - 보기싫은 AOP를 떼어내버리고 인터셉터로 접근시 매번 권한 MAP을 체크하도록 설정


#### 참고자료
  - http://blog.engintruder.com/263
  - https://developyo.tistory.com/272

※ 추가 확인 필요 : HTTP-HEADER 객체의 종류 


다른 내용 >> WEB-INF 이외의 JSP 페이지의 직접접근을 막는방법 (WEB.XML)

 - https://kimsg.tistory.com/122 